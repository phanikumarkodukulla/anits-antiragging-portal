<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body class="student-page">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="/">
          <i class="fas fa-shield-alt"></i> Anti-Ragging Portal
        </a>
        <a
          href="/"
          class="btn btn-sm"
          style="
            background: #ffc107;
            color: #000;
            border: none;
            font-weight: 600;
          "
        >
          <i class="fas fa-arrow-left me-2"></i>Back to Home
        </a>
      </div>
    </nav>

    <div class="container my-5">
      <div class="row justify-content-center">
        <div class="col-lg-7 col-xl-6">
          <!-- Page Title -->
          <div class="text-center mb-5">
            <div class="mb-3">
              <i
                class="fas fa-search-location fa-4x"
                style="color: var(--primary-blue); opacity: 0.9"
              ></i>
            </div>
            <h1 class="fw-bold mb-2" style="color: #000000">
              Track Your Complaint
            </h1>
            <p class="lead text-muted">
              Enter your complaint ID to check the status and updates
            </p>
          </div>

          <div
            class="card shadow-lg border-0"
            style="border-radius: 20px; overflow: hidden"
          >
            <div
              style="
                background: linear-gradient(
                  135deg,
                  var(--primary-blue) 0%,
                  #1e4d7b 100%
                );
                padding: 2.5rem 2rem;
              "
            >
              <div class="text-center text-white">
                <div class="mb-3">
                  <i class="fas fa-fingerprint fa-3x" style="opacity: 0.9"></i>
                </div>
                <h4 class="mb-2 fw-bold">Complaint Tracker</h4>
                <p class="mb-0 opacity-75">
                  Real-time status monitoring system
                </p>
              </div>
            </div>

            <div
              class="card-body p-4 p-md-5"
              style="
                background: linear-gradient(
                  to bottom,
                  #f8f9fc 0%,
                  #ffffff 100%
                );
              "
            >
              <% if (error) { %>
              <div
                class="alert alert-danger alert-dismissible fade show border-0 shadow-sm"
              >
                <i class="fas fa-exclamation-circle me-2"></i
                ><strong>Error:</strong> <%= error %>
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="alert"
                ></button>
              </div>
              <% } %>

              <form action="/complaint/track" method="POST">
                <div class="mb-4">
                  <label
                    class="form-label fw-bold d-flex align-items-center mb-3"
                    style="color: var(--primary-blue); font-size: 1.1rem"
                  >
                    <i class="fas fa-id-card me-2"></i>
                    Enter Complaint ID
                  </label>

                  <div class="position-relative">
                    <span
                      class="position-absolute top-50 start-0 translate-middle-y ms-3"
                      style="color: var(--primary-blue); font-size: 1.3rem"
                    >
                      <i class="fas fa-hashtag"></i>
                    </span>
                    <input
                      type="text"
                      class="form-control form-control-lg text-center font-monospace shadow-sm"
                      name="complaintId"
                      placeholder="CMP-ABC123-XYZ"
                      value="<%= complaint ? complaint.complaintId : '' %>"
                      required
                      autofocus
                      style="
                        letter-spacing: 2px;
                        font-size: 1.3rem;
                        padding: 0.9rem 1rem 0.9rem 2.5rem;
                        border: 2px solid #e0e6ed;
                        border-radius: 12px;
                        background: white;
                        transition: all 0.3s ease;
                      "
                      onfocus="this.style.borderColor='var(--primary-blue)'; this.style.boxShadow='0 0 0 0.2rem rgba(42, 89, 155, 0.15)'"
                      onblur="this.style.borderColor='#e0e6ed'; this.style.boxShadow=''"
                    />
                  </div>

                  <div class="mt-3 d-flex align-items-center text-muted">
                    <i
                      class="fas fa-info-circle me-2"
                      style="color: var(--primary-blue)"
                    ></i>
                    <small
                      >This unique ID was provided when you submitted your
                      complaint</small
                    >
                  </div>
                </div>

                <div class="d-grid gap-2">
                  <button
                    type="submit"
                    class="btn btn-lg shadow"
                    style="
                      background: linear-gradient(
                        135deg,
                        var(--primary-blue) 0%,
                        #1e4d7b 100%
                      );
                      border: none;
                      color: white;
                      padding: 0.9rem;
                      border-radius: 12px;
                      font-weight: 600;
                      font-size: 1.1rem;
                      transition: all 0.3s ease;
                    "
                  >
                    <i class="fas fa-search me-2"></i>Track Complaint Status
                  </button>
                </div>
              </form>

              <% if (complaint) { %>

              <!-- Results Section -->
              <div class="mt-5">
                <div class="text-center mb-4">
                  <div class="mb-3">
                    <i
                      class="fas fa-check-circle fa-3x"
                      style="color: #28a745"
                    ></i>
                  </div>
                  <h4 class="fw-bold mb-1">Complaint Found!</h4>
                  <p class="text-muted">
                    Here are the details of your complaint
                  </p>
                </div>

                <!-- Status Badge - Large and Prominent -->
                <div
                  class="card border-0 shadow-lg mb-4"
                  style="border-radius: 16px; overflow: hidden"
                >
                  <div
                    style="
                      background: linear-gradient(
                        135deg,
                        <%= complaint.status === 'Resolved' ? '#28a745':
                          complaint.status === 'In Review' ? '#17a2b8':
                          '#ffc107' %> 0%,
                        <%= complaint.status === 'Resolved' ? '#20c997':
                          complaint.status === 'In Review' ? '#138496':
                          '#e0a800' %> 100%
                      );
                      padding: 2rem;
                    "
                  >
                    <div class="text-center text-white">
                      <div class="mb-3">
                        <% if (complaint.status === 'Resolved') { %>
                        <i class="fas fa-check-circle fa-4x"></i>
                        <% } else if (complaint.status === 'In Review') { %>
                        <i class="fas fa-hourglass-half fa-4x"></i>
                        <% } else { %>
                        <i class="fas fa-clock fa-4x"></i>
                        <% } %>
                      </div>
                      <h3 class="mb-2 fw-bold"><%= complaint.status %></h3>
                      <p class="mb-0 opacity-75">
                        Current Status of Your Complaint
                      </p>
                    </div>
                  </div>
                </div>

                <!-- Complaint Details Card -->
                <div
                  class="card border-0 shadow-sm mb-4"
                  style="border-radius: 16px; overflow: hidden"
                >
                  <div
                    style="
                      background: linear-gradient(
                        135deg,
                        var(--primary-blue) 0%,
                        #1e4d7b 100%
                      );
                      padding: 1.5rem;
                    "
                  >
                    <h5 class="mb-0 text-white fw-bold">
                      <i class="fas fa-file-alt me-2"></i>Complaint Details
                    </h5>
                  </div>
                  <div class="card-body p-4">
                    <div class="row g-4">
                      <div class="col-12">
                        <div
                          class="p-3 rounded"
                          style="
                            background: linear-gradient(
                              135deg,
                              #f8f9fa 0%,
                              #e9ecef 100%
                            );
                          "
                        >
                          <div class="d-flex align-items-start">
                            <i
                              class="fas fa-heading text-primary me-3 mt-1"
                              style="font-size: 1.3rem"
                            ></i>
                            <div class="flex-grow-1">
                              <small class="text-muted d-block mb-1 fw-semibold"
                                >Complaint Title</small
                              >
                              <p class="mb-0 fw-bold" style="font-size: 1.1rem">
                                <%= complaint.title %>
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div
                          class="p-3 rounded"
                          style="
                            background: linear-gradient(
                              135deg,
                              #fff5f5 0%,
                              #ffe5e5 100%
                            );
                          "
                        >
                          <div class="d-flex align-items-center">
                            <i
                              class="fas fa-exclamation-triangle me-3"
                              style="font-size: 1.5rem; color: #dc3545"
                            ></i>
                            <div>
                              <small class="text-muted d-block mb-1 fw-semibold"
                                >Severity Level</small
                              >
                              <span
                                class="badge px-3 py-2"
                                style="font-size: 1rem; background: <%= complaint.severity === 'High' ? '#dc3545' : complaint.severity === 'Medium' ? '#ffc107' : '#17a2b8' %>;"
                              >
                                <%= complaint.severity %>
                              </span>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div
                          class="p-3 rounded"
                          style="
                            background: linear-gradient(
                              135deg,
                              #f0f8ff 0%,
                              #e0f0ff 100%
                            );
                          "
                        >
                          <div class="d-flex align-items-center">
                            <i
                              class="fas fa-hashtag me-3"
                              style="
                                font-size: 1.5rem;
                                color: var(--primary-blue);
                              "
                            ></i>
                            <div>
                              <small class="text-muted d-block mb-1 fw-semibold"
                                >Complaint ID</small
                              >
                              <p
                                class="mb-0 font-monospace fw-bold"
                                style="font-size: 0.95rem; letter-spacing: 1px"
                              >
                                <%= complaint.complaintId %>
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div
                          class="p-3 rounded"
                          style="
                            background: linear-gradient(
                              135deg,
                              #f0fff4 0%,
                              #d9f2e6 100%
                            );
                          "
                        >
                          <div class="d-flex align-items-center">
                            <i
                              class="fas fa-calendar-plus me-3"
                              style="font-size: 1.5rem; color: #28a745"
                            ></i>
                            <div>
                              <small class="text-muted d-block mb-1 fw-semibold"
                                >Submitted On</small
                              >
                              <p class="mb-0 fw-bold">
                                <%= new
                                Date(complaint.createdAt).toLocaleDateString('en-US',
                                { year: 'numeric', month: 'short', day:
                                'numeric' }) %>
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div
                          class="p-3 rounded"
                          style="
                            background: linear-gradient(
                              135deg,
                              #fff9f0 0%,
                              #ffe9d9 100%
                            );
                          "
                        >
                          <div class="d-flex align-items-center">
                            <i
                              class="fas fa-clock me-3"
                              style="font-size: 1.5rem; color: #fd7e14"
                            ></i>
                            <div>
                              <small class="text-muted d-block mb-1 fw-semibold"
                                >Last Updated</small
                              >
                              <p class="mb-0 fw-bold">
                                <%= new
                                Date(complaint.updatedAt).toLocaleDateString('en-US',
                                { year: 'numeric', month: 'short', day:
                                'numeric' }) %>
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Action Taken Report (if available) -->
                <% if (complaint.actionTakenReport) { %>
                <div
                  class="card border-0 shadow-sm mb-4"
                  style="border-radius: 16px; overflow: hidden"
                >
                  <div
                    style="
                      background: linear-gradient(
                        135deg,
                        #28a745 0%,
                        #20c997 100%
                      );
                      padding: 1.5rem;
                    "
                  >
                    <h5 class="mb-0 text-white fw-bold">
                      <i class="fas fa-clipboard-check me-2"></i>Action Taken
                      Report
                    </h5>
                  </div>
                  <div class="card-body p-4">
                    <div
                      class="p-3 rounded"
                      style="
                        background: linear-gradient(
                          135deg,
                          #f0fff4 0%,
                          #d9f2e6 100%
                        );
                      "
                    >
                      <i
                        class="fas fa-quote-left text-success mb-2"
                        style="font-size: 1.5rem; opacity: 0.5"
                      ></i>
                      <p
                        class="mb-0 ms-3"
                        style="font-size: 1.05rem; line-height: 1.7"
                      >
                        <%= complaint.actionTakenReport %>
                      </p>
                    </div>
                  </div>
                </div>
                <% } %>

                <!-- Public Remarks (if available) -->
                <% if (complaint.publicRemarks) { %>
                <div
                  class="card border-0 shadow-sm mb-4"
                  style="border-radius: 16px; overflow: hidden"
                >
                  <div
                    style="
                      background: linear-gradient(
                        135deg,
                        #17a2b8 0%,
                        #138496 100%
                      );
                      padding: 1.5rem;
                    "
                  >
                    <h5 class="mb-0 text-white fw-bold">
                      <i class="fas fa-comment-dots me-2"></i>Public Remarks
                    </h5>
                  </div>
                  <div class="card-body p-4">
                    <div
                      class="p-3 rounded"
                      style="
                        background: linear-gradient(
                          135deg,
                          #f0f8ff 0%,
                          #e0f0ff 100%
                        );
                      "
                    >
                      <i
                        class="fas fa-quote-left text-info mb-2"
                        style="font-size: 1.5rem; opacity: 0.5"
                      ></i>
                      <p
                        class="mb-0 ms-3"
                        style="font-size: 1.05rem; line-height: 1.7"
                      >
                        <%= complaint.publicRemarks %>
                      </p>
                    </div>
                  </div>
                </div>
                <% } %>

                <!-- Status Timeline -->
                <div
                  class="card border-0 shadow-sm"
                  style="border-radius: 16px; overflow: hidden"
                >
                  <div
                    style="
                      background: linear-gradient(
                        135deg,
                        #6c757d 0%,
                        #495057 100%
                      );
                      padding: 1.5rem;
                    "
                  >
                    <h5 class="mb-0 text-white fw-bold">
                      <i class="fas fa-stream me-2"></i>Status Timeline
                    </h5>
                  </div>
                  <div
                    class="card-body p-4 p-md-5"
                    style="
                      background: linear-gradient(
                        135deg,
                        #f8f9fa 0%,
                        #ffffff 100%
                      );
                    "
                  >
                    <div
                      class="d-flex justify-content-between align-items-center position-relative py-4"
                      style="min-height: 160px"
                    >
                      <!-- Progress Line -->
                      <div
                        class="position-absolute top-50 start-0 end-0 translate-middle-y"
                        style="
                          height: 6px;
                          background: linear-gradient(
                            90deg,
                            #e9ecef 0%,
                            #dee2e6 100%
                          );
                          z-index: 1;
                          border-radius: 10px;
                        "
                      ></div>
                      <div
                        class="position-absolute top-50 start-0 translate-middle-y"
                        style="height: 6px; width: <%= complaint.status === 'Resolved' ? '100%' : complaint.status === 'In Review' ? '50%' : '16%' %>; background: linear-gradient(90deg, #28a745 0%, #20c997 50%, #17a2b8 100%); z-index: 1; transition: width 0.8s ease; border-radius: 10px; box-shadow: 0 2px 10px rgba(40, 167, 69, 0.4);"
                      ></div>

                      <!-- Step 1: Submitted -->
                      <div
                        class="text-center position-relative"
                        style="z-index: 2; flex: 1"
                      >
                        <div class="px-2">
                          <small
                            class="fw-bold d-block mb-1"
                            style="color: #28a745; font-size: 0.95rem"
                            >Submitted</small
                          >
                          <small
                            class="text-muted d-block"
                            style="font-size: 0.85rem"
                            ><%= new
                            Date(complaint.createdAt).toLocaleDateString('en-US',
                            { month: 'short', day: 'numeric' }) %></small
                          >
                        </div>
                      </div>

                      <!-- Step 2: In Review -->
                      <div
                        class="text-center position-relative"
                        style="z-index: 2; flex: 1"
                      >
                        <div class="px-2">
                          <small
                            class="fw-bold d-block mb-1"
                            style="color: <%= complaint.status === 'In Review' || complaint.status === 'Resolved' ? '#17a2b8' : '#6c757d' %>; font-size: 0.95rem;"
                            >In Review</small
                          >
                          <small
                            class="text-muted d-block"
                            style="font-size: 0.85rem"
                            ><%= complaint.status === 'In Review' ||
                            complaint.status === 'Resolved' ? 'Processing' :
                            'Pending' %></small
                          >
                        </div>
                      </div>

                      <!-- Step 3: Resolved -->
                      <div
                        class="text-center position-relative"
                        style="z-index: 2; flex: 1"
                      >
                        <div class="px-2">
                          <small
                            class="fw-bold d-block mb-1"
                            style="color: <%= complaint.status === 'Resolved' ? '#28a745' : '#6c757d' %>; font-size: 0.95rem;"
                            >Resolved</small
                          >
                          <small
                            class="text-muted d-block"
                            style="font-size: 0.85rem"
                            ><%= complaint.status === 'Resolved' ? new
                            Date(complaint.updatedAt).toLocaleDateString('en-US',
                            { month: 'short', day: 'numeric' }) : 'Awaiting'
                            %></small
                          >
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <% } %>
            </div>
          </div>

          <div class="text-center mt-4">
            <a href="/" class="btn btn-outline-primary">
              <i class="fas fa-home me-2"></i>Return to Home
            </a>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
